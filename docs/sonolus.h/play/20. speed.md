# 独立下落速度

在本章中，您将会学习到:

- 如何实现独立下落速度

## 独立下落速度

独立下落速度是节奏游戏中的另一个普遍功能，每一个按键都可能以不同的速度下落。在某些游戏中，按键的下落速度是由 BPM 决定的，而在另外一些游戏中，它有可能被手动调整以创建有意思的效果。

在我们的引擎中，我们将基于 BPM 来实现不同速度的下落。

当前所有按键的下落速度都是相同的，因为按键的位置是在最小和最大可视时间内插值得到的，并且最小可视时间仅仅是简单的将最大可视时间减 `1` 得到的。为了改变下落速度，我们可以简单地改变下落时间。

让我们假设 `120` BPM 对应 `1` 秒的下落时间，否则按照 BPM 的大小进行缩放。(例如 `240` BPM 对应 `0.5` 秒的下落时间)

```cpp title='/engine/play/Note.cpp'
class Note: public Archetype {
    // ...

    SonolusApi preprocess() {
        FUNCBEGIN
        // ...

        minVisualTime = maxVisualTime - 120 / BeatToBPM(beat);

        // ...
        return VOID;
    }

    // ...
};
```